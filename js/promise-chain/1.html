<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <script>
        const posts = [
            { title: 'I love JavaScript', author: 'Wes Bos', id: 1 },
            { title: 'CSS!', author: 'Chris Coyier', id: 2 },
            { title: 'Dev tools tricks', author: 'Addy Osmani', id: 3 },
        ];
        const authors = [
            { name: 'Wes Bos', twitter: '@www', bio: 'WWW' },
            { name: 'Chris Coyier', twitter: '@xxx', bio: 'XXX' },
            { name: 'Addy Osmani', twitter: '@yyy', bio: 'YYY' },
        ];

        function getPostsById(id) {
            return new Promise((resolve, reject) => {
                setTimeout(() => {
                    //es6 find
                    const post = posts.find(post => post.id === id);
                    if(post){
                        resolve(post)
                    }else{ 
                        reject(Error('Post not found'))
                    }
                }, 1000);
            })
        }

        function getAuthorByPost(post) {
            return new Promise((resolve, reject) => {
                setTimeout(() => {
                    const authorDetail = authors.find(author => author.name === post.author);
                    if (authorDetail) {
                        post.author = authorDetail;
                        resolve(post)
                    } else {
                        reject(Error('Author not find'))
                    }
                }, 1000)
            })
        }
        // getPostsById(1)
        //     .then(post => {
        //         console.log(post)
        //         getAuthorByPost(post)
        //             .then(post => {
        //                 console.log(post)
        //             })
        //     })
        // getPostsById(1)
        //     .then(post => {
        //         return getAuthorByPost(post)

        //     })
        // // getAuthorByPost(post)
        //     .then(author => {
        //         console.log(author)
        //     })
        //     .catch(err => {
        //         console.error(err)
        //     })
            (async () => {
                try{
                const post  = await getPostsById(1);
                console.log(post)
                const author = await getAuthorByPost(post);
                console.log(author);
            } catch (error){
                console.error(err);
            }
            })()
        //   .then(post => {
        //     console.log(post)
        //     return post;
        //   })
        //   .then(post => {
        //     console.log(post)
        //     return post;
        //   })
    </script>
</body>

</html>